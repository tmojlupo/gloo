
---
title: "waf.proto"
weight: 5
---

<!-- Code generated by solo-kit. DO NOT EDIT. -->


### Package: `envoy.config.filter.http.modsecurity.v2` 
#### Types:


- [AuditLogging](#auditlogging)
- [AuditLogAction](#auditlogaction)
- [AuditLogLocation](#auditloglocation)
- [ModSecurity](#modsecurity)
- [RuleSet](#ruleset)
- [ModSecurityPerRoute](#modsecurityperroute)
  



##### Source File: [github.com/solo-io/gloo/projects/gloo/api/external/envoy/extensions/waf/waf.proto](https://github.com/solo-io/gloo/blob/master/projects/gloo/api/external/envoy/extensions/waf/waf.proto)





---
### AuditLogging



```yaml
"action": .envoy.config.filter.http.modsecurity.v2.AuditLogging.AuditLogAction
"location": .envoy.config.filter.http.modsecurity.v2.AuditLogging.AuditLogLocation

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `action` | [.envoy.config.filter.http.modsecurity.v2.AuditLogging.AuditLogAction](../waf.proto.sk/#auditlogaction) |  |  |
| `location` | [.envoy.config.filter.http.modsecurity.v2.AuditLogging.AuditLogLocation](../waf.proto.sk/#auditloglocation) |  |  |




---
### AuditLogAction



| Name | Description |
| ----- | ----------- | 
| `NEVER` | Never generate audit logs. |
| `RELEVANT_ONLY` | When set to RELEVANT_ONLY, this will have similar behavior to `SecAuditEngine RelevantOnly`. |
| `ALWAYS` | Always generate an audit log entry (as long as the filter is not disabled). |




---
### AuditLogLocation



| Name | Description |
| ----- | ----------- | 
| `FILTER_STATE` | Add the audit log to the filter state. it will be under the key "io.solo.modsecurity.audit_log". You can use this formatter in the access log: %FILTER_STATE(io.solo.modsecurity.audit_log)% |
| `DYNAMIC_METADATA` | Add the audit log to the dynamic metadata. it will be under the filter name "io.solo.filters.http.modsecurity". with "audit_log" as the key. You can use this formatter in the access log: %DYNAMIC_METADATA("io.solo.filters.http.modsecurity:audit_log")% |




---
### ModSecurity



```yaml
"disabled": bool
"ruleSets": []envoy.config.filter.http.modsecurity.v2.RuleSet
"customInterventionMessage": string
"auditLogging": .envoy.config.filter.http.modsecurity.v2.AuditLogging
"requestHeadersOnly": bool
"responseHeadersOnly": bool
"regressionLogs": bool

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `disabled` | `bool` | Disable all rules on the current route. |  |
| `ruleSets` | [[]envoy.config.filter.http.modsecurity.v2.RuleSet](../waf.proto.sk/#ruleset) | Global rule sets for the current http connection manager. |  |
| `customInterventionMessage` | `string` | Custom message to display when an intervention occurs. |  |
| `auditLogging` | [.envoy.config.filter.http.modsecurity.v2.AuditLogging](../waf.proto.sk/#auditlogging) | This instructs the filter what to do with the transaction's audit log. |  |
| `requestHeadersOnly` | `bool` | If set, the body will not be buffered and fed to ModSecurity. Only the headers will. This can help improve performance. |  |
| `responseHeadersOnly` | `bool` |  |  |
| `regressionLogs` | `bool` | log in a format suited for the OWASP regression tests. this format is a multiline log format, so it is disabled for regular use. do not enable this in production!. |  |




---
### RuleSet



```yaml
"ruleStr": string
"files": []string
"directory": string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `ruleStr` | `string` | String of rules which are added directly. |  |
| `files` | `[]string` | Array of files to include. |  |
| `directory` | `string` | A directory to include. all *.conf files in this directory will be included. sub directories will NOT be checked. |  |




---
### ModSecurityPerRoute



```yaml
"disabled": bool
"ruleSets": []envoy.config.filter.http.modsecurity.v2.RuleSet
"customInterventionMessage": string
"auditLogging": .envoy.config.filter.http.modsecurity.v2.AuditLogging
"requestHeadersOnly": bool
"responseHeadersOnly": bool

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `disabled` | `bool` | Disable all rules on the current route. |  |
| `ruleSets` | [[]envoy.config.filter.http.modsecurity.v2.RuleSet](../waf.proto.sk/#ruleset) | Overwrite the global rules on this route. |  |
| `customInterventionMessage` | `string` | Custom message to display when an intervention occurs. |  |
| `auditLogging` | [.envoy.config.filter.http.modsecurity.v2.AuditLogging](../waf.proto.sk/#auditlogging) | This instructs the filter what to do with the transaction's audit log. |  |
| `requestHeadersOnly` | `bool` | If set, the body will not be buffered and fed to ModSecurity. Only the headers will. This can help improve performance. |  |
| `responseHeadersOnly` | `bool` |  |  |





<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5130874.js"></script>
<!-- End of HubSpot Embed Code -->
